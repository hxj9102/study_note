# http & https

http: http -> tcp -> ip

https: http -> ssl/tls -> tcp -> ip

## https

### 主要作用：

对数据进行加密，并建立一个信息通道，来保证传输过程中的数据安全

对网站服务器进行真实身份认证

https = http + 加密 + 认证 + 完整性保护 = http + SSL/TLS

利用SSL/TLS加密数据包

### SSL/TLS工作原理：

依赖于三类算法：散列函数Hash、对称加密、非对称加密

利用非对称加密实现*身份认证*和密钥协商，对称加密算法采用协商的密钥对数据*加密*，基于散列函数验证信息的*完整性*

B/S通信流程：

1. C向S请求https连接

2. S返回证书（公钥）

3. C使用公钥对对称密钥进行加密

4. C向S发送加密后的对称密钥

5. 通过对称密钥加密的密文通信

以上通信存在的隐患：中间人攻击和信息抵赖

* 客户端C和服务器S进行通信，中间节点M截获了二者的通信;
* 节点M自己计算产生一对公钥pub_M和私钥pri_M;
* C向S请求公钥时，M把自己的公钥pub_M发给了C;
* C使用公钥 pub_M加密的数据能够被M解密，因为M掌握对应的私钥pri_M，而 C无法根据公钥信息判断服务器的身份，从而 C和M之间建立了"可信"加密连接;
* 中间节点 M和服务器S之间再建立合法的连接，因此 C和 S之间通信被M完全掌握，M可以进行信息的窃听、篡改等操作。
* 另外，服务器也可以对自己的发出的信息进行否认，不承认相关信息是自己发出。

如何解决以上存在的隐患？

1. 确保获取公钥的途径是合法的

2. 能够验证服务器的身份

由此需要引入第三方机构CA

基本原理：

CA负责审核信息，然后对关键信息利用私钥进行“签名”，公开对应的公钥，客户端可以利用公钥验证签名



## 五层协议结构

应用层

运输层（TCP或UPD）

网络层（IP）

数据链路层

物理层
